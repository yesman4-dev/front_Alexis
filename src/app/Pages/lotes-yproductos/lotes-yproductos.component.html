<div class="contenedor-lotes">

  <h2 class="titulo">Lotes PrÃ³ximos a Vencer</h2>

  <!-- Spinner de carga -->
  <div *ngIf="cargando" class="spinner">
    <p>Cargando lotes... â³</p>
  </div>

  <!-- Mensaje de error -->
  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
  </div>

  <!-- Tabla de lotes -->
  <div *ngIf="!cargando && !error && lotesPaginados.length > 0" class="tabla-responsive">
    <table class="tabla-lotes">
      <thead>
        <tr>
          <th>Bodega</th>
          <th>Producto</th>
          <th>PresentaciÃ³n</th>
          <th>CÃ³digo Lote</th>
          <th>Vencimiento</th>
          <th>DÃ­as Restantes</th>
          <th>Stock Cajas</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let lote of lotesPaginados"
            [ngClass]="{
              'critico': lote.diasRestantes <= 30,
              'advertencia': lote.diasRestantes > 30 && lote.diasRestantes <= 60,
              'ok': lote.diasRestantes > 60 && lote.diasRestantes <= 90
            }">
          <td>{{ lote.bodega }}</td>
          <td>{{ lote.producto }}</td>
          <td>{{ lote.presentacion }}</td>
          <td>{{ lote.codigoLote }}</td>
          <td>{{ lote.fechaVencimiento | date:'dd/MM/yyyy' }}</td>
          <td>
            {{ lote.diasRestantes }}
            <span [title]="'Estado de vencimiento'"
                  [ngClass]="{
                    'icon-rojo': lote.diasRestantes <= 30,
                    'icon-naranja': lote.diasRestantes > 30 && lote.diasRestantes <= 60,
                    'icon-verde': lote.diasRestantes > 60 && lote.diasRestantes <= 90
                  }">â¬¤</span>
          </td>
          <td>{{ lote.stockActual }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mensaje si no hay lotes -->
  <div *ngIf="!cargando && !error && lotes.length === 0" class="sin-datos">
    <p>No se encontraron lotes prÃ³ximos a vencer. ğŸ‰</p>
  </div>

  <!-- PaginaciÃ³n -->
  <div *ngIf="totalPaginas > 1" class="paginacion">
    <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1">Â« Anterior</button>

    <ng-container *ngFor="let pagina of [].constructor(totalPaginas); let i = index">
      <button (click)="cambiarPagina(i + 1)" [class.activo]="paginaActual === (i + 1)">{{ i + 1 }}</button>
    </ng-container>

    <button (click)="cambiarPagina(paginaActual + 1)" [disabled]="paginaActual === totalPaginas">Siguiente Â»</button>
  </div>

</div>
